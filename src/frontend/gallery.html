<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Galerie - Rezervace chaty</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  </head>
  <body>
    <div class="app-wrapper">
      <div id="app-container" class="app-container hidden">
        <div class="top-bar">
          <nav class="app-nav">
            <a href="index.html" class="nav-link">Rezervace</a>
            <a href="notes.html" class="nav-link">Nástěnka</a>
            <a href="gallery.html" class="nav-link active">Galerie</a>
            <a href="diary.html" class="nav-link">Deník</a>
            <!-- NOVÝ ODKAZ -->
          </nav>
          <div class="user-info">
            <span class="username-display">Přihlášen jako: <strong id="logged-in-username"></strong></span>
            <button id="logout-button" class="button-logout"><i class="fas fa-sign-out-alt"></i> Odhlásit se</button>
          </div>
        </div>

        <!-- Hlavní kontejner galerie -->
        <div class="main-content-gallery">
          <div class="card gallery-card">
            <!-- 1. POHLED: SEZNAM SLOŽEK -->
            <div id="folders-view" style="display: flex; flex-direction: column; height: 100%">
              <div class="gallery-header">
                <h2><i class="fas fa-images"></i> Fotoalba</h2>
              </div>

              <!-- Wrapper pro obsah, který se roztáhne -->
              <div class="gallery-content-wrapper">
                <div id="folders-grid" class="folders-grid">
                  <!-- Složky se načtou dynamicky -->
                </div>
              </div>

              <!-- Patička s tlačítky - upraveno pro zarovnání smazat/přejmenovat -->
              <div class="gallery-footer">
                <div class="footer-left folder-actions-group">
                  <!-- Zde bude tlačítko Přejmenovat, zobrazí se jen při zaškrtnuté složce -->
                  <button id="rename-folder-btn" class="gallery-btn gallery-btn-secondary" style="display: none"><i class="fas fa-edit"></i> Přejmenovat</button>
                </div>
                <div class="footer-right">
                  <button id="create-folder-btn" class="gallery-btn gallery-btn-primary"><i class="fas fa-plus"></i> Nové album</button>
                  <!-- Tlačítko Smazat je nyní zde, napravo v patičce pro jednotné rozložení -->
                  <button id="delete-folder-list-btn" class="gallery-btn gallery-btn-danger" style="display: none"><i class="fas fa-trash-alt"></i> Smazat album</button>
                </div>
              </div>
            </div>

            <!-- 2. POHLED: OBSAH SLOŽKY (FOTKY) -->
            <div id="photos-view" style="display: none; flex-direction: column; height: 100%">
              <div class="gallery-header" style="justify-content: space-between">
                <h2 id="current-folder-title">Název alba</h2>
                <div class="header-actions">
                  <!-- Tlačítko pro smazání celé složky je nyní v patičce -->
                </div>
              </div>

              <div class="gallery-content-wrapper">
                <!-- Grid pro fotky - fixní layout -->
                <div id="photos-grid" class="photos-grid">
                  <!-- Fotky se načtou dynamicky -->
                </div>
              </div>

              <!-- Patička s ovládáním -->
              <div class="gallery-footer">
                <div class="footer-left">
                  <button id="back-to-folders-btn" class="gallery-btn gallery-btn-secondary">Zpět</button>
                  <div class="selection-controls" style="margin-left: 10px; display: flex; gap: 10px">
                    <button id="toggle-selection-btn" class="gallery-btn gallery-btn-secondary"><i class="fas fa-check-square"></i> Vybrat</button>
                    <button id="delete-selected-btn" class="gallery-btn gallery-btn-danger" style="display: none">
                      <i class="fas fa-trash"></i> Smazat vybrané (<span id="selection-count">0</span>)
                    </button>
                  </div>
                </div>

                <div class="footer-center">
                  <!-- Stránkování -->
                  <div id="pagination-controls" class="pagination-controls" style="display: none">
                    <button id="prev-page-btn" class="nav-arrow"><i class="fas fa-chevron-left"></i></button>
                    <span id="page-info">1 / 1</span>
                    <button id="next-page-btn" class="nav-arrow"><i class="fas fa-chevron-right"></i></button>
                  </div>
                </div>

                <div class="footer-right">
                  <button id="upload-photo-btn" class="gallery-btn gallery-btn-primary"><i class="fas fa-cloud-upload-alt"></i> Nahrát fotky</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Login Container -->
      <div id="auth-container" class="login-container card hidden">
        <h2>Přihlášení</h2>
        <p>Pro zobrazení galerie se prosím <a href="index.html">přihlaste</a>.</p>
      </div>
    </div>

    <!-- MODAL: VYTVOŘIT SLOŽKU -->
    <div id="create-folder-modal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <span class="modal-close-button">&times;</span>
        <h2>Vytvořit nové album</h2>
        <form id="create-folder-form">
          <div class="form-group">
            <label for="folder-name-input">Název alba:</label>
            <input type="text" id="folder-name-input" placeholder="např. Léto 2025" required />
          </div>
          <div class="modal-buttons">
            <button type="submit" class="gallery-btn gallery-btn-primary" style="width: 100%">Vytvořit</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL: PŘEJMENOVAT SLOŽKU (NOVÝ) -->
    <div id="rename-folder-modal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <span class="modal-close-button">&times;</span>
        <h2>Přejmenovat album</h2>
        <p>Zadejte nový název pro album: <strong id="old-folder-name"></strong></p>
        <form id="rename-folder-form">
          <input type="hidden" id="rename-folder-id-input" />
          <div class="form-group">
            <label for="new-folder-name-input">Nový název:</label>
            <input type="text" id="new-folder-name-input" required minlength="1" maxlength="50" />
            <p id="rename-error-msg" class="error-message" style="display: none"></p>
          </div>
          <div class="modal-buttons">
            <button type="submit" class="gallery-btn gallery-btn-primary">Uložit nové jméno</button>
            <button type="button" class="gallery-btn gallery-btn-secondary modal-close-button" data-modal-id="rename-folder-modal">Zrušit</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL: DELETE FOLDER WARNING (ADMIN) -->
    <div id="delete-folder-modal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <span class="modal-close-button">&times;</span>
        <h2 style="color: #ef4444"><i class="fas fa-exclamation-triangle"></i> Varování</h2>
        <p>Toto album obsahuje fotografie. Pokud ho smažete, <strong>všechny fotografie uvnitř budou nenávratně ztraceny</strong>.</p>
        <p>Pro potvrzení smazání napište do pole níže slovo <strong>DELETE</strong>.</p>

        <form id="delete-folder-form">
          <div class="form-group">
            <input type="text" id="delete-confirm-input" placeholder="DELETE" class="input-danger" required />
          </div>
          <div class="modal-buttons">
            <button type="submit" class="gallery-btn gallery-btn-danger" style="width: 100%">Potvrdit smazání</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL: NAHRÁT FOTKY -->
    <div id="upload-photo-modal" class="modal-overlay" style="display: none">
      <div class="modal-content upload-modal-content">
        <span class="modal-close-button">&times;</span>
        <h2>Nahrát fotky</h2>

        <!-- Loading Overlay uvnitř modálu (Spinner) -->
        <div id="upload-loading-overlay" class="loading-overlay" style="display: none">
          <div class="spinner"></div>
          <p>Nahrávám fotky, prosím čekejte...</p>
        </div>

        <form id="upload-photo-form" class="upload-form-styled">
          <div class="file-upload-container">
            <div class="file-drop-area">
              <i class="fas fa-images upload-icon"></i>
              <p class="file-msg">Vyberte fotky z vašeho zařízení</p>

              <!-- Skrytý input -->
              <input type="file" id="photo-file-input" accept="image/*" multiple required />

              <!-- Custom tlačítko -->
              <label for="photo-file-input" class="custom-file-label">Vyber soubor</label>
              <span id="file-chosen-text" class="file-chosen-text">Nevybrán žádný soubor</span>
            </div>
          </div>
          <div class="modal-buttons">
            <button type="submit" class="gallery-btn gallery-btn-primary" style="width: 100%">Nahrát</button>
          </div>
        </form>
      </div>
    </div>

    <!-- LIGHTBOX (DETAIL FOTKY) -->
    <div id="lightbox-modal" class="lightbox-overlay" style="display: none">
      <button id="lightbox-close" class="lightbox-close">&times;</button>
      <div class="lightbox-content">
        <img id="lightbox-img" src="" alt="Detail fotky" />

        <!-- Sekce pro popisek (Vzpomínky) -->
        <div class="lightbox-caption-container">
          <p id="lightbox-description" class="lightbox-description" title="Klikni pro úpravu"></p>
          <button id="add-description-btn" class="add-description-btn" style="display: none"><i class="fas fa-pen"></i> Napsat vzpomínku...</button>

          <div id="description-form" class="description-form" style="display: none">
            <input type="text" id="description-input" class="description-input" placeholder="Napiš, co se na fotce děje..." maxlength="150" />
            <button id="save-description-btn" class="save-description-btn">Uložit</button>
          </div>
        </div>

        <!-- Ovládání v detailu -->
        <div class="lightbox-controls">
          <a id="lightbox-download" href="#" download class="lightbox-btn"> <i class="fas fa-download"></i> Stáhnout </a>
          <button id="lightbox-delete" class="lightbox-btn lightbox-btn-danger" style="display: none"><i class="fas fa-trash"></i> Smazat</button>
        </div>
      </div>
      <button id="lightbox-prev" class="lightbox-arrow left"><i class="fas fa-chevron-left"></i></button>
      <button id="lightbox-next" class="lightbox-arrow right"><i class="fas fa-chevron-right"></i></button>
    </div>

    <!-- SUCCESS NOTIFICATION TOAST -->
    <div id="success-toast" class="toast">
      <i class="fas fa-check-circle"></i>
      <span>Akce provedena úspěšně.</span>
    </div>

    <script src="gallery.js"></script>
  </body>
</html>
